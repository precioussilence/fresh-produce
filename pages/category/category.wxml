<!--pages/category/category.wxml-->
<custom-navbar title="分类" />
<view class="side-bar-wrapper" style="height: calc(100vh - {{navbarHeight}}px)">
  <view>
    <t-side-bar value="{{sideBarIndex}}" bind:change="onSideBarChange">
      <t-side-bar-item
        wx:for="{{categories}}"
        wx:key="label"
        value="{{item.value || index}}"
        label="{{item.label}}"
        disabled="{{item.disabled}}"
        badge-props="{{item.badgeProps}}"
      />
    </t-side-bar>
  </view>
  <view class="content" style="transform: translateY(-{{sideBarIndex * 100 + '%'}})">
    <scroll-view
      wx:for="{{categories}}"
      wx:key="label"
      class="section"
      scroll-y
      scroll-top="{{scrollTop}}"
      scroll-with-animation
      show-scrollbar="{{false}}"
    >
      <view class="title">{{item.title || item.label}}</view>
      <t-cell-group>
        <block wx:for="{{goodsList}}" wx:key="index" wx:for-item="goods">
          <t-cell
            arrow="false"
            data-id="{{goods.id}}"
            bind:click="onGoodsClick"
            t-class="goods-cell"
          >
            <view slot="left-icon" class="goods-left">
              <t-image src="{{goods.image}}" mode="aspectFill" t-class="goods-image" />
            </view>
            <view slot="title" class="goods-right">
              <view class="goods-title">{{goods.title}}</view>
              <view class="goods-bottom">
                <view class="goods-price-info">
                  <view class="goods-price">
                    <text class="goods-price-symbol">¥</text>{{goods.price}}
                  </view>
                  <view class="goods-original-price">¥{{goods.originalPrice}}</view>
                  <view class="goods-sold">已售{{goods.soldCount}}件</view>
                </view>
                <view class="goods-cart">
                  <t-icon name="cart" size="36rpx" data-id="{{goods.id}}" catch:tap="onAddToCart" />
                </view>
              </view>
            </view>
          </t-cell>
        </block>
      </t-cell-group>
    </scroll-view>
  </view>
</view>
